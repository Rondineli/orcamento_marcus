function IncrementValue(e){var t="#"+e,a=e.split("_")[2];return jqxhr=$.ajax("/stock/disponible/"+a,{data:$(this).serialize(),type:"GET",dataType:"json"}),jqxhr.done(function(e){if("ok"==e.status){var a=parseInt($(t).val())+1;a>parseInt(e.total_disponible)?($(t).val(parseInt(e.total_disponible)),Materialize.toast("Ops... Quantidade excede o disponível em estoque :'(",4e3)):$(t).val(parseInt($(t).val())+1)}else Materialize.toast("Erro ao consultar a estoque: "+e.message,4e4)}),!1}function DecrementValue(e){var t="#"+e;0==parseInt($(t).val())?Materialize.toast("Valor não pode ser menor que 0",4e3):$(t).val(parseInt($(t).val())-1)}function func_show_item(e){found=e.search(e);var t="/"+e+"/create/";if(-1!=found)var e=e.replace(new RegExp("/","g"),"_");var a="#"+e,o=document.getElementById("div_forms_configurations"),l=document.createElement("div");l.id=e,o.appendChild(l),$.get(t,function(t){$(a).html(t),document.getElementById(e).style.display=""}),func_clear_specific_item(e)}function AddOrDeleteItem(e){if(e.checked)array_delete.push(e.id);else for(var t=0;t<array_delete.length;t++)array_delete[t]==e.id&&delete array_delete[t]}function PostRemove(){for(var e=[],t=0;t<array_delete.length;t++)array_delete[t]&&e.push(array_delete[t].split("_")[1]);$("#list_removes").html("IDs: "+e),$("#modalRemove").openModal()}function SendSignalRemove(e){for(var t=0;t<array_delete.length;t++)if(array_delete[t]){var a=e+array_delete[t].split("_")[1]+"/";$("#remove_form").attr("action",a).submit()}}function UpdatePaymentTable(){var e=parseFloat($("#total_account_label").text()).toFixed(2),t=parseFloat($("#all_paid").text()).toFixed(2),a=parseFloat(e-t);0>a?($("#for_change").text(parseFloat(-1*a).toFixed(2)),$("#value_for_paid").text(a.toFixed(2))):a>0?($("#value_for_paid").text(a.toFixed(2)),$("#for_change").text("00.00")):($("#value_for_paid").text("00.00"),$("#all_paid").text(a.toFixed(2)),$("#for_change").text("00.00"))}function GetCellValues(){var e=[];return $("#table_products tr").each(function(){var t=$(this).closest("tr").find("td:eq(0)").html();t&&$.isNumeric(t)&&e.push(t.replace(/(\r\n|\n|\r| )/gm,""))}),e}function getCookie(e){var t=null;if(document.cookie&&""!=document.cookie)for(var a=document.cookie.split(";"),o=0;o<a.length;o++){var l=jQuery.trim(a[o]);if(l.substring(0,e.length+1)==e+"="){t=decodeURIComponent(l.substring(e.length+1));break}}return t}function CheckIsNaN(e){return isNaN(e)&&(console.log("ified..."),e="0.00"),console.log(isNaN(e)),e}function ajax_send_payment(){var e=new Object,t=GetCellValues();return e.all_value=$("#total_value_table").text().replace(/(\r\n|\n|\r| )/gm,""),e.include_couvert=$("#deactive_cover").is(":checked"),e.include_rate=$("#deactive_rate").is(":checked"),e.type_calculate=$("#calculate_options").val(),e.discount=CheckIsNaN(parseFloat($("#total_disccount").val()).toFixed(2)),e.rate=CheckIsNaN(parseFloat($("#new_value").val()).toFixed(2)),console.log(e.rate),e.table_id=$("#table").val(),e["orders[]"]=t.toString(),e.csrfmiddlewaretoken=getCookie("csrftoken"),e.payments=[],e.payments.push({payment_method:$("#payment_method").val()}),e.payments.push({payment_value:$("#value_paid").val()}),e.type_calculate||(console.log("ifedd...here"),e.type_calculate="R$"),console.log(e.orders),e.payments.push("debit"==e.payments[0].payment_method||"credit"==e.payments[0].payment_method?{flag:$("#flags_payments").val()}:"ticket"==e.payments[0].payment_method?{flag:$("#vr_flags_payments").val()}:"check"==e.payments[0].payment_method?{flag:$("#total_payd_check").val()}:{flag:"money"}),e.payments=JSON.stringify(e.payments),e}function CalculatePayment(e){function t(e){if(1==e){var t=ajax_send_payment();t.is_closed=!0,post_data(t)}else{var t=ajax_send_payment();t.is_closed=!1,post_data(t)}}var a=parseFloat(String(e.val()).replace(",",".")),o=parseFloat($("#all_paid").text().replace(",","."));if(value_paid_fixed+=1,!isNaN(a)&&!isNaN(o)){var l=parseFloat(parseFloat($("#all_paid").text())+parseFloat(a)),n=parseFloat(parseFloat($("#total_account_label").text())-parseFloat(l));0>n?($("#for_change").text(n=-1*n),$("#all_paid").text(l.toFixed(2)),$("#total_value_paid").text(l.toFixed(2)),$("#value_for_paid").text(parseFloat(-1*n).toFixed(2)),$("#btn_closed_account").attr("disabled",!1)):n>0?($("#all_paid").text(l.toFixed(2)),$("#value_for_paid").text(n.toFixed(2)),$("#total_value_paid").text(l.toFixed(2))):($("#all_paid").text(l.toFixed(2)),$("#total_value_paid").text(l.toFixed(2)),$("#value_for_paid").text(n.toFixed(2)),$("#btn_closed_account").attr("disabled",!1));var r=parseFloat($("#total_value_paid").text().replace(",",".")),i=parseFloat($("#total_account_label").text().replace(",","."));if(r>i||r==i){var d=$("#modal1");d.openModal(),$(".modal-action.modal-close").on("click",function(){var e=$(this).data("action");t(e)})}else{var s=ajax_send_payment();s.is_closed=!1,post_data(s)}addRowTable("add","table_products",a,value_paid_fixed,"","Valor pago de conta",3)}}function post_data(e){return console.log("posted..."),jqxhr=$.ajax({data:e,type:"POST",url:window.location.pathname}),console.log("intiate...s"),jqxhr.done(function(e){console.log("initate okeyssss..."),console.log(e),"ok"==e.status?Materialize.toast(e.message,4e3):Materialize.toast("Erro encontrado: "+e.message,4e4)}),jqxhr.fail(function(){Materialize.toast("Falha na comunicação com o servidores",4e4)}),!1}function DeactiveRate(e,t,a,o){if(add_rate=o?!0:!1,"rate"==t&&0==e.checked){var l=$("#all_value_rate").text();if(l){var n=parseFloat(l.split(" ")[1]);addRowTable("add","table_products",n,"rate_discount","Entrada/Taxa de serviço"),$("#total_account_label").text(parseFloat(parseFloat($("#total_account_label").text())-n).toFixed(2)),$("#total_value_table").text(parseFloat(parseFloat($("#total_value_table").text())-n).toFixed(2))}}else if("rate"==t&&1==e.checked&&!a&&0==add_rate){var l=$("#all_value_rate").text();if(l){var n=parseFloat(l.split(" ")[1]);addRowTable("remove","table_products",n,"rate_discount","Entrada/Taxa de serviço"),$("#total_account_label").text(parseFloat(parseFloat($("#total_account_label").text())+n).toFixed(2)),$("#total_value_table").text(parseFloat(parseFloat($("#total_value_table").text())+n).toFixed(2))}}if("cover"==t&&0==e.checked){var r=$("#all_value_cover").text();if(r){var n=parseFloat(r.split(" ")[1]);addRowTable("add","table_products",n,"cover_discount","cover"),$("#total_account_label").text(parseFloat(parseFloat($("#total_account_label").text())-n).toFixed(2)),$("#total_value_table").text(parseFloat(parseFloat($("#total_value_table").text())-n).toFixed(2))}}else if("cover"==t&&1==e.checked&&!a&&0==add_rate){var l=$("#all_value_cover").text();if(l){var n=parseFloat(l.split(" ")[1]);addRowTable("remove","table_products",n,"cover_discount","cover"),$("#total_account_label").text(parseFloat(parseFloat($("#total_account_label").text())+n).toFixed(2)),$("#total_value_table").text(parseFloat(parseFloat($("#total_value_table").text())+n).toFixed(2))}}UpdatePaymentTable()}function PaymentsOptions(e){var t={money:"payments_type_money",check:"payments_type_check",credit:"payment_cards_cb",debit:"payment_cards_cb",ticket:"payment_cards_vr"};for(option in t)if(option!=e){var a=document.getElementById(t[option]);a.style.display="none"}document.getElementById(t[e]).style.display="","money"!=t[e]&&$("#payments_type_money").show(),$("#payment_button").show()}function deleteRowTable(e,t){var a=document.getElementById(t);return a&&a.parentNode.removeChild(a),!1}function OnChangeCalculate(){var e=$("#total_disccount").val(),t=$("#new_value").val();t&&AddValue(t),e&&DiscountFunction(e)}function changedOptionCalculate(e){var t=document.getElementById(e),a=t.options[t.selectedIndex].text;return"%"!=a&&"R$"!=a?(alert("O calculo do desconto e de acrésimos serão realizados pelo valor padrão (R$), caso queira o calculo em (%) escolha na opção: 'Calcular em' do lado esquerdo"),$(".select-dropdown").val("R$"),t.options[t.selectedIndex].text="R$","R$"):"R$"==a?"R$":"%"==a?"%":void 0}function validate(e){var t=e||window.event,a=t.keyCode||t.which;a=String.fromCharCode(a);var o=/^[0-9,\9\b]*\.?[0-9]*$/;o.test(a)||8==e.keyCode||9==e.keyCode||(t.returnValue=!1,t.preventDefault&&t.preventDefault())}function ShowEditModal(e,t,a){$.get(e,function(e){$(t).html(e),$(a).openModal()})}function ShowTable(e){var e=$(e).DataTable({language:{lengthMenu:"Mostrando _MENU_ por pagina",zeroRecords:"Sem resultados, desculpe :(",infoEmpty:"Sem registros, desculpe :(",info:"Mostrando paginas _PAGE_ de _PAGES_",infoFiltered:"(Filtrando de _MAX_)"}})}function func_clear_specific_item(e){for(var t=document.getElementById("div_forms_configurations").childNodes,a=0;a<t.length;a++)t[a].id&&t[a].id!=e&&t[a].style&&t[a].remove()}function func_clear(){var e=document.getElementById("div_forms_configurations").childNodes;e.remove()}!function(e){e.Chart.prototype.createCanvas=function(){var e=this.getSVG(),t=parseInt(e.match(/width="([0-9]+)"/)[1]),a=parseInt(e.match(/height="([0-9]+)"/)[1]),o=document.createElement("canvas");return o.setAttribute("width",t),o.setAttribute("height",a),o.getContext&&o.getContext("2d")?(canvg(o,e),o.toDataURL("image/jpeg")):(alert("Your browser doesn't support this feature, please use a modern browser"),!1)}}(Highcharts),$("#export_all").click(function(){var e=new jsPDF("p","mm","a4"),t={"#editor":function(){return!0}},a=80;e.setFontSize(80),e.text(35,25,"Relatório de modulo gerencial"),e.fromHTML($("#table_content").get(0),15,15,{width:300,height:100,elementHandlers:t}),e.addPage(),$(".myChart").each(function(t){var o=$(this).highcharts().createCanvas();console.log(t),e.addImage(o,"JPEG",45,t*a+40,120,a)});var o=new Date,l="report_estoque"+o.getDate()+"_"+(parseInt(o.getMonth())+parseInt(1))+o.getFullYear()+".pdf";e.save(l)}),$("#print_all").click(function(){window.print()}),$(document).ready(function(){$("select").material_select()}),$("#form_company input[name='enabled_photo']").click(function(){var e=document.getElementById("file_input_company");e.style.display="none"==e.style.display?"":"none"}),$("#form_branch input[name='enabled_photo']").click(function(){var e=document.getElementById("file_input_branch");e.style.display="none"==e.style.display?"":"none"});var array_delete=[],value_paid_fixed=0;